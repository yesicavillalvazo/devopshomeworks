#This is an example webapp.io configuration for Angular
FROM vm/ubuntu:18.04

# To note: Layerfiles create entire VMs, *not* containers!


# Install nvm, Node.js, and npm
RUN bash -c "wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash" && \
    export NVM_DIR="$HOME/.nvm" && \
    [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh" && \
    [ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion" && \
    nvm install 18.13 && nvm use 18.13

# install angular CLI
RUN npm install -g @angular/cli@latest


RUN ng build --optimization=false
# small hack - node doesn't persist in destination of a COPY
RUN BACKGROUND ng serve --host 0.0.0.0 --disable-host-check
EXPOSE WEBSITE http://localhost:4200

